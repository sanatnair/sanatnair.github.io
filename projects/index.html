<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Projects · Sanat Nair</title>
  <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>
  <div class="container">
    <div class="nav">
      <div class="left"><a href="../"><strong>SN</strong></a></div>
      <div class="right"><a href="../Resume_SN.pdf">Résumé</a><a href="../">Home</a></div>
    </div>
    <div class="header">
      <h1>All GitHub Repositories</h1>
      <p class="subtitle">Live list from <a href="https://github.com/sanatnair" target="_blank">github.com/sanatnair</a>. Use GitHub topics to organize — add <code class="code">portfolio-featured</code> to pin repos on the home page.</p>
    </div>
    <div style="margin:12px 0;">
      <button class="btn" id="sort-updated">Sort by Updated</button>
      <button class="btn" id="sort-stars">Sort by Stars</button>
      <button class="btn" id="sort-name">Sort by Name</button>
    </div>
    <div id="list" class="grid"></div>
  </div>
<script>
const USER="sanatnair";
const LIST=document.getElementById("list");
let DATA=[];

const CARD=(repo)=>{
  const topics = (repo.topics||[]).slice(0,4).map(t=>`<span class="tag">${t}</span>`).join("");
  const lang = repo.language ? `<span class="tag">${repo.language}</span>` : "";
  const stats = [`★ ${repo.stargazers_count||0}`, `⎇ ${repo.forks_count||0}`].join(" · ");
  return `<a class="card" href="${repo.html_url}" target="_blank" rel="noreferrer">
    <img src="https://opengraph.githubassets.com/1/${repo.full_name}" alt="${repo.name} preview" loading="lazy">
    <h3>${repo.name}</h3>
    <p>${repo.description || "No description provided."}</p>
    <div>${lang} ${topics}</div>
    <p class="subtitle" style="margin-top:8px;">${stats}</p>
  </a>`;
};

function render(){ LIST.innerHTML = DATA.map(CARD).join(""); }

async function load(){
  try{
    const r = await fetch(`https://api.github.com/users/${USER}/repos?per_page=100`, { headers: { "Accept": "application/vnd.github+json" }});
    const data = await r.json();
    DATA = Array.isArray(data) ? data : [];
    DATA.sort((a,b)=> new Date(b.pushed_at)-new Date(a.pushed_at));
    render();
  } catch(e){
    LIST.innerHTML = '<div class="card"><h3>Error loading repos</h3><p class="subtitle">Please try again later.</p></div>';
    console.error(e);
  }
}
load();

document.getElementById("sort-updated").onclick = ()=>{ DATA.sort((a,b)=> new Date(b.pushed_at)-new Date(a.pushed_at)); render(); };
document.getElementById("sort-stars").onclick = ()=>{ DATA.sort((a,b)=> (b.stargazers_count||0)-(a.stargazers_count||0)); render(); };
document.getElementById("sort-name").onclick    = ()=>{ DATA.sort((a,b)=> a.name.localeCompare(b.name)); render(); };
</script>
</body>
</html>
